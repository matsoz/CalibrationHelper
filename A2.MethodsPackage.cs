using MathNet.Numerics.Statistics;
using System;
using System.IO;
using System.Windows.Forms;


namespace CalibrationHelper
{
    static public class TabManagementMethods
    {
        static public double PointsDist2D(double Xa, double Ya, double Xb, double Yb)
        {
            return Math.Sqrt(Math.Pow(Xa - Xb, 2) + Math.Pow(Ya - Yb, 2));
        }

        static public double LinearInterpolation(double XSel, double[] XBkpt, double[] ZTab)
        {
            double XIndex = 0;
            byte X_BDOffset = 1;

            // Find X interpolation factor
            if (XSel < XBkpt[0])
            {
                XIndex = 0;
            }
            else if (XSel >= XBkpt[(XBkpt.Length) - 1])
            {
                XIndex = (XBkpt.Length) - 1;
                X_BDOffset = 0;
            }
            else
            {
                for (int i = 0; i < XBkpt.Length - 1; i++)
                {
                    if (XSel >= XBkpt[i] && XSel < XBkpt[i + 1])
                    {
                        XIndex = i + ((XSel - XBkpt[i]) / (XBkpt[i + 1] - XBkpt[i]));
                        break;
                    }
                }
            }

            // Interpolate within ZTab using XIndex factors
            double XIndexFrac = 0;
            int XIndexInt = 0;

            XIndexInt = (int)Math.Truncate(XIndex);
            XIndexFrac = XIndex - XIndexInt;

            double ZValueA, ZValueB, ZValue;

            ZValueA = ZTab[XIndexInt];
            ZValueB = ZTab[XIndexInt + X_BDOffset];

            ZValue = ((ZValueA * (1 - XIndexFrac)) + (ZValueB * XIndexFrac));

            return ZValue;
        }

        static public double BilinearInterpolation(double XSel, double YSel, double[] XBkpt, double[] YBkpt, double[,] ZTab)
        {
            double XIndex = 0, YIndex = 0;
            byte X_BDOffset = 1, Y_CDOffset = 1;

            // Find X interpolation factor
            if (XSel < XBkpt[0])
            {
                XIndex = 0;
            }
            else if (XSel >= XBkpt[(XBkpt.Length) - 1])
            {
                XIndex = (XBkpt.Length) - 1;
                X_BDOffset = 0;
            }
            else
            {
                for (int i = 0; i < XBkpt.Length - 1; i++)
                {
                    if (XSel >= XBkpt[i] && XSel < XBkpt[i + 1])
                    {
                        XIndex = i + ((XSel - XBkpt[i]) / (XBkpt[i + 1] - XBkpt[i]));
                        break;
                    }
                }
            }

            // Find Y interpolation factor
            if (YSel < YBkpt[0])
            {
                YIndex = 0;
            }
            else if (YSel >= YBkpt[(YBkpt.Length) - 1])
            {
                YIndex = (YBkpt.Length) - 1;
                Y_CDOffset = 0;
            }
            else
            {
                for (int i = 0; i < YBkpt.Length - 1; i++)
                {
                    if (YSel >= YBkpt[i] && YSel < YBkpt[i + 1])
                    {
                        YIndex = i + ((YSel - YBkpt[i]) / (YBkpt[i + 1] - YBkpt[i]));
                        break;
                    }
                }
            }

            // Interpolate within ZTab using XIndex and YIndex factors
            double XIndexFrac = 0, YIndexFrac = 0;
            int XIndexInt = 0, YIndexInt = 0;

            XIndexInt = (int)Math.Truncate(XIndex);
            YIndexInt = (int)Math.Truncate(YIndex);
            XIndexFrac = XIndex - XIndexInt;
            YIndexFrac = YIndex - YIndexInt;

            double ZValueA, ZValueB, ZValueC, ZValueD, ZValue;

            ZValueA = ZTab[YIndexInt, XIndexInt];
            ZValueB = ZTab[YIndexInt, XIndexInt + X_BDOffset];
            ZValueC = ZTab[YIndexInt + Y_CDOffset, XIndexInt];
            ZValueD = ZTab[YIndexInt + Y_CDOffset, XIndexInt + X_BDOffset];

            ZValue = (1 - YIndexFrac) * ((ZValueA * (1 - XIndexFrac)) + (ZValueB * XIndexFrac)) +
                     (YIndexFrac) * ((ZValueC * (1 - XIndexFrac)) + (ZValueD * XIndexFrac));

            return ZValue;
        }
    }

    static public class VectorStatBasicMethods
    {
        static public double Mean(double[] Array)
        {
            if (Array.Length > 0)
            {
                return Statistics.Mean(Array);
            }
            else
            {
                return 0;
            }

        }

        static public double MeanWeighted(double[] Array, double[] Weight, int WeightPow)
        {
            if (Array.Length > 0)
            {
                double AccumDen = 0, AccumNum = 0;

                for (int i = 0; i < Array.Length; i++)
                {
                    AccumNum += Array[i] * Math.Pow(Weight[i], WeightPow);
                    AccumDen += Math.Pow(Weight[i], WeightPow);
                }

                return AccumNum / AccumDen;
            }
            else
            {
                return 0;
            }

        } //Type 1 for linear, 2 for  Quadratic, etc

        static public double StdDev(double[] Array)
        {
            if (Array.Length > 0)
            {
                return Statistics.StandardDeviation(Array);
            }
            else
            {
                return 0;
            }

        }

        static public double ErrorsAvg(double[] ArrayA, double[] ArrayB)
        {
            if (ArrayA.Length != ArrayB.Length)
            {
                return 0;
            }

            double Err = 0;
            for (int i = 0; i < ArrayA.Length; i++)
            {
                Err += ArrayA[i] - ArrayB[i];
            }

            return Err / ArrayA.Length;
        }

        static public double ErrorsStdDev(double[] ArrayA, double[] ArrayB)
        {
            if (ArrayA.Length != ArrayB.Length)
            {
                return 0;
            }

            double[] Err = new double[ArrayA.Length];

            for (int i = 0; i < ArrayA.Length; i++)
            {
                Err[i] = (ArrayA[i] - ArrayB[i]);
            }

            return VectorStatBasicMethods.StdDev(Err);
        }
    }

    static public class TransformationMethods
    {
        static public double[] TextLin2VectorLin(string TextVal)
        {
            //Pre treatment of "TextVal" string, removing doubled space characters
            while (TextVal.Contains("\t"))
            {
                TextVal = TextVal.Replace("\t", " ");
            }
            while (TextVal.Contains("  "))
            {
                TextVal = TextVal.Replace("  ", " ");
            }

            //Transformation step -> String "TextVal" to Vector "VectVal"
            string[] TextValSplit = (TextVal.Trim(' ')).Split(' ');
            double[] VectVal = new double[TextValSplit.Length];
            int i;


            for (i = 0; i < TextValSplit.Length; i++)
            {
                VectVal[i] = double.Parse(TextValSplit[i]);
            }
            return VectVal;

        }

        static public double[] TextCol2VectorCol(string TextVal)
        {
            //Pre treatment of "TextVal" string, removing space characters and doubled linebreaks
            while (TextVal.Contains("\t"))
            {
                TextVal = TextVal.Replace("\t", " ");
            }
            while (TextVal.Contains(" "))
            {
                TextVal = TextVal.Replace(" ", "");
            }
            while (TextVal.Contains("\r\n\r\n"))
            {
                TextVal = TextVal.Replace("\r\n\r\n", "\r\n");
            }
            while (TextVal.Contains(" \r\n"))
            {
                TextVal = TextVal.Replace(" \r\n", "\r\n");
            }
            while (TextVal.Contains("\r\n "))
            {
                TextVal = TextVal.Replace("\r\n ", "\r\n");
            }

            //Transformation step -> String "TextVal" to Vector "VectVal"
            string[] LinBrk = new string[] { "\r\n" }; //Define LineBreak std. string 
            string[] TextValSplit = ((TextVal.Trim('\r', '\n')).Split(LinBrk, StringSplitOptions.None));
            double[] VectVal = new double[((TextVal.Trim('\r', '\n')).Split(LinBrk, StringSplitOptions.None)).Length];
            int i;

            for (i = 0; i < TextValSplit.Length; i++)
            {
                VectVal[i] = double.Parse(TextValSplit[i]);
            }
            return VectVal;
        }

        static public double[,] TextTable2VectorTable(string TextVal)
        {

            //Pre treatment of "TextVal" string, removing doubled space characters and doubled linebreaks
            while (TextVal.Contains("\t"))
            {
                TextVal = TextVal.Replace("\t", " ");
            }
            while (TextVal.Contains("  "))
            {
                TextVal = TextVal.Replace("  ", " ");
            }
            while (TextVal.Contains("\r\n\r\n"))
            {
                TextVal = TextVal.Replace("\r\n\r\n", "\r\n");
            }
            while (TextVal.Contains(" \r\n"))
            {
                TextVal = TextVal.Replace(" \r\n", "\r\n");
            }
            while (TextVal.Contains("\r\n "))
            {
                TextVal = TextVal.Replace("\r\n ", "\r\n");
            }

            //Transformation step -> String "TextVal" to Matrix "TableVal"
            string[] LinBrk = new string[] { "\r\n" }; //Define LineBreak std. string 
            string[] TextValSplitLin = ((TextVal.Trim('\r', '\n')).Split(LinBrk, StringSplitOptions.None));
            double[,] TableVal = new double[((TextVal.Trim('\r', '\n')).Split(LinBrk, StringSplitOptions.None)).Length,
                                    1 + ((TextVal.Split(' ')).Length / ((TextVal.Trim('\r', '\n')).Split(LinBrk, StringSplitOptions.None)).Length)];

            int LinNum = 1 + TableVal.GetUpperBound(0);
            int ColNum = 1 + TableVal.GetUpperBound(1);

            for (int i = 0; i < LinNum; i++)
            {
                string[] TextValSplitLinCol = (TextValSplitLin[i].Trim(' ')).Split(' ');
                for (int j = 0; j < ColNum; j++)
                {
                    TableVal[i, j] = double.Parse(TextValSplitLinCol[j]);
                }
            }

            return TableVal;
        }

        static public string VectorTable2TextTable(double[,] VectorTable)
        {
            string TextTable = ""; //= new string[2 * (VectorTable.GetUpperBound(0)+1) * (VectorTable.GetUpperBound(1)+1)];

            for (int i = 0; i < 1 + VectorTable.GetUpperBound(0); i++) //i sweeps Y
            {
                for (int j = 0; j < 1 + VectorTable.GetUpperBound(1); j++)//j sweeps X
                {
                    TextTable = String.Concat(TextTable, VectorTable[i, j], "\t");
                }
                TextTable = String.Concat(TextTable, "\r\n");
            }
            return TextTable;
        }

        static public string VectorCol2TextCol(double[] Vector)
        {
            string TextVector = "";

            for (int i = 0; i < 1 + Vector.GetUpperBound(0); i++)
            {
                TextVector = String.Concat(TextVector, Vector[i], "\r\n");
            }
            return TextVector;
        }

        static public string VectorLin2TextLin(double[] Vector)
        {
            string TextVector = "";

            for (int i = 0; i < 1 + Vector.GetUpperBound(0); i++)
            {
                TextVector = String.Concat(TextVector, Vector[i], "\t");
            }
            return TextVector;
        }
    }

    static public class CalibrationMethods
    {
        static public double[] CalibrationRatioArrayCalculation(double[] DataX, double[] DataY, double[] DataZ,
                                                            double[] XBkpt, double[] YBkpt, double[,] ZTab)
        {
            if (DataX.Length == DataY.Length && DataY.Length == DataZ.Length) //Check Data size plausibility
            {
                double[] ZRatioArray = new double[DataX.Length];

                for (int i = 0; i < DataX.Length; i++)
                {
                    if (TabManagementMethods.BilinearInterpolation(DataX[i], DataY[i], XBkpt, YBkpt, ZTab) != 0)
                    {
                        DataZ[i] = DataZ[i] == 0 ? 0.00000001 : DataZ[i];

                        ZRatioArray[i] = DataZ[i] / TabManagementMethods.BilinearInterpolation(DataX[i], DataY[i], XBkpt, YBkpt, ZTab);
                    }
                    else if (TabManagementMethods.BilinearInterpolation(DataX[i], DataY[i], XBkpt, YBkpt, ZTab) == 0 && DataZ[i] == 0)
                    {
                        ZRatioArray[i] = 0;
                    }
                    else
                    {
                        DataZ[i] = DataZ[i] == 0 ? 0.00000001 : DataZ[i];

                        ZRatioArray[i] = DataZ[i] / 0.00000001;
                    }
                }

                return ZRatioArray;
            }
            else
            {
                throw new System.ArgumentException("The X, Y and Z data arrays are not the same size", "original");
            }
        } //Calculates ratio between Z from Data vs. Z from Table

        static public double[] CalibrationAbsoluteArrayCalculation(double[] DataX, double[] DataY, double[] DataZ,
                                                           double[] XBkpt, double[] YBkpt, double[,] ZTab)
        {
            if (DataX.Length == DataY.Length && DataY.Length == DataZ.Length) //Check Data size plausibility
            {
                double[] ZArray = new double[DataX.Length];

                for (int i = 0; i < DataX.Length; i++)
                {
                    if (TabManagementMethods.BilinearInterpolation(DataX[i], DataY[i], XBkpt, YBkpt, ZTab) != 0)
                    {
                        ZArray[i] = TabManagementMethods.BilinearInterpolation(DataX[i], DataY[i], XBkpt, YBkpt, ZTab);
                    }
                    else
                    {
                        ZArray[i] = 0;
                    }
                }

                return ZArray;
            }
            else
            {
                throw new System.ArgumentException("The X, Y and Z data arrays are not the same size", "original");
            }
        } //Calculates abs. difference between Z from Data vs. Z from Table

        static public double[,] CalibrationTabOptimizationWiPB(double MeanTar, int PrecisionTar,
                                                            int WeightBox, int FineTuneIterBox, int FineTuneSubIterBox, bool FitType,
                                                            double[] DataX, double[] DataY, double[] DataZ,
                                                            double[] XBkpt, double[] YBkpt, double[,] ZTab,
                                                            ref ProgressBoxInvokation ProgressBox, ref double[] ErrStep, ref double[] StdDStep) // WiPB = With Progress Box
        {
            double X_A, X_B, Y_A, Y_B, ZMeanInterval;
            double[,] ZWorkTab = new double[1 + ZTab.GetUpperBound(0), 1 + ZTab.GetUpperBound(1)];
            double[] ZRatio = new double[DataZ.Length];
            byte[,] ZTabStatus = new byte[1 + ZTab.GetUpperBound(0), 1 + ZTab.GetUpperBound(1)];


            //0. Populate the iteration converging error vector (first position) to be plotted afterwards
            if (FitType == false)
            {
                ErrStep[ErrStep.GetLowerBound(0)] = VectorStatBasicMethods.ErrorsAvg(DataZ,
                     CalibrationMethods.CalibrationAbsoluteArrayCalculation(DataX, DataY, DataZ, XBkpt, YBkpt, ZTab));
                StdDStep[ErrStep.GetLowerBound(0)] = VectorStatBasicMethods.ErrorsStdDev(DataZ,
                      CalibrationMethods.CalibrationAbsoluteArrayCalculation(DataX, DataY, DataZ, XBkpt, YBkpt, ZTab));
            }
            else
            {
                ErrStep[ErrStep.GetLowerBound(0)] = VectorStatBasicMethods.Mean(
                     CalibrationMethods.CalibrationAbsoluteArrayCalculation(DataX, DataY, DataZ, XBkpt, YBkpt, ZTab));
                StdDStep[ErrStep.GetLowerBound(0)] = VectorStatBasicMethods.StdDev(
                       CalibrationMethods.CalibrationAbsoluteArrayCalculation(DataX, DataY, DataZ, XBkpt, YBkpt, ZTab));
            }

            //1. Sweep each table point and get average value from delivered data
            for (int i = 0; i < 1 + ZWorkTab.GetUpperBound(0); i++) //i sweeps Y
            {
                for (int j = 0; j < 1 + ZWorkTab.GetUpperBound(1); j++)//j sweeps X
                {
                    //1.1 Select interval around table current point - X Values
                    if (j == 0)
                    {
                        X_A = XBkpt[j] - ((XBkpt[j + 1] - XBkpt[j]) / 2);
                        X_B = (XBkpt[j + 1] + XBkpt[j]) / 2;
                    }
                    else if (j == ZWorkTab.GetUpperBound(1))
                    {
                        X_A = (XBkpt[j] + XBkpt[j - 1]) / 2;
                        X_B = XBkpt[j] + ((XBkpt[j] - XBkpt[j - 1]) / 2);
                    }
                    else
                    {
                        X_A = (XBkpt[j] + XBkpt[j - 1]) / 2;
                        X_B = (XBkpt[j + 1] + XBkpt[j]) / 2;
                    }

                    //1.2 Select interval around table current point - Y Values
                    if (i == 0)
                    {
                        Y_A = YBkpt[i] - ((YBkpt[i + 1] - YBkpt[i]) / 2);
                        Y_B = (YBkpt[i + 1] + YBkpt[i]) / 2;
                    }
                    else if (i == ZWorkTab.GetUpperBound(0))
                    {
                        Y_A = (YBkpt[i] + YBkpt[i - 1]) / 2;
                        Y_B = YBkpt[i] + ((YBkpt[i] - YBkpt[i - 1]) / 2);
                    }
                    else
                    {
                        Y_A = (YBkpt[i] + YBkpt[i - 1]) / 2;
                        Y_B = (YBkpt[i + 1] + YBkpt[i]) / 2;
                    }

                    //1.3 Collect data corresponding to the targeted interval
                    int m_A = 0, m_B = 0, m_C = 0, m_D = 0;
                    //1.3.1 Num. of positions needed for each array
                    for (int k = 0; k < DataX.Length; k++)
                    {
                        m_A += (DataX[k] >= X_A && DataX[k] < XBkpt[j] && DataY[k] >= Y_A && DataY[k] < YBkpt[i]) ? 1 : 0;
                        m_B += (DataX[k] >= XBkpt[j] && DataX[k] < X_B && DataY[k] >= Y_A && DataY[k] < YBkpt[i]) ? 1 : 0;
                        m_C += (DataX[k] >= X_A && DataX[k] < XBkpt[j] && DataY[k] >= YBkpt[i] && DataY[k] < Y_B) ? 1 : 0;
                        m_D += (DataX[k] >= XBkpt[j] && DataX[k] < X_B && DataY[k] >= YBkpt[i] && DataY[k] < Y_B) ? 1 : 0;
                    }

                    double[] DataZSel_A = new double[m_A];
                    double[] DataZWei_A = new double[m_A];

                    double[] DataZSel_B = new double[m_B];
                    double[] DataZWei_B = new double[m_B];

                    double[] DataZSel_C = new double[m_C];
                    double[] DataZWei_C = new double[m_C];

                    double[] DataZSel_D = new double[m_D];
                    double[] DataZWei_D = new double[m_D];

                    m_A = 0;
                    m_B = 0;
                    m_C = 0;
                    m_D = 0;

                    //1.3.2 - Z values and weight calculation for each interval
                    for (int k = 0; k < DataX.Length; k++)
                    {
                        if (DataX[k] >= X_A && DataX[k] < XBkpt[j] && DataY[k] >= Y_A && DataY[k] < YBkpt[i])
                        {
                            DataZSel_A[m_A] = DataZ[k];
                            DataZWei_A[m_A] = TabManagementMethods.PointsDist2D((DataX[k] - X_A) / (XBkpt[j] - X_A),
                                                                                (DataY[k] - Y_A) / (YBkpt[i] - Y_A),
                                                                                0, 0);
                            m_A++;
                        }
                        else if (DataX[k] >= XBkpt[j] && DataX[k] < X_B && DataY[k] >= Y_A && DataY[k] < YBkpt[i])
                        {
                            DataZSel_B[m_B] = DataZ[k];
                            DataZWei_B[m_B] = TabManagementMethods.PointsDist2D((DataX[k] - X_B) / (XBkpt[j] - X_B),
                                                                                (DataY[k] - Y_A) / (YBkpt[i] - Y_A),
                                                                                0, 0);
                            m_B++;
                        }
                        else if (DataX[k] >= X_A && DataX[k] < XBkpt[j] && DataY[k] >= YBkpt[i] && DataY[k] < Y_B)
                        {
                            DataZSel_C[m_C] = DataZ[k];
                            DataZWei_C[m_C] = TabManagementMethods.PointsDist2D((DataX[k] - X_A) / (XBkpt[j] - X_A),
                                                                                (DataY[k] - Y_B) / (YBkpt[i] - Y_B),
                                                                                0, 0);
                            m_C++;
                        }
                        else if (DataX[k] >= XBkpt[j] && DataX[k] < X_B && DataY[k] >= YBkpt[i] && DataY[k] < Y_B)
                        {
                            DataZSel_D[m_D] = DataZ[k];
                            DataZWei_D[m_D] = TabManagementMethods.PointsDist2D((DataX[k] - X_B) / (XBkpt[j] - X_B),
                                                                                (DataY[k] - Y_B) / (YBkpt[i] - Y_B),
                                                                                0, 0);
                            m_D++;
                        }
                    }

                    //1.4 Calculate ZMean, within selected interval
                    byte b_A = 1, b_B = 1, b_C = 1, b_D = 1;

                    b_A = DataZSel_A.Length == 0 ? (byte)0 : (byte)1;
                    b_B = DataZSel_B.Length == 0 ? (byte)0 : (byte)1;
                    b_C = DataZSel_C.Length == 0 ? (byte)0 : (byte)1;
                    b_D = DataZSel_D.Length == 0 ? (byte)0 : (byte)1;

                    ZMeanInterval = (b_A * VectorStatBasicMethods.MeanWeighted(DataZSel_A, DataZWei_A, WeightBox) +
                        b_B * VectorStatBasicMethods.MeanWeighted(DataZSel_B, DataZWei_B, WeightBox) +
                        b_C * VectorStatBasicMethods.MeanWeighted(DataZSel_C, DataZWei_C, WeightBox) +
                        b_D * VectorStatBasicMethods.MeanWeighted(DataZSel_D, DataZWei_D, WeightBox)) / (b_A + b_B + b_C + b_D);

                    //1.5 Input mean optimized value (based on data) in ZWorkTab
                    ZWorkTab[i, j] = ZMeanInterval;

                    //1.6 Track/Flag the table values which didn't have associated data to be calculated
                    ZTabStatus[i, j] = (b_A + b_B + b_C + b_D == 0) ? (byte)0 : (byte)1;
                    ZWorkTab[i, j] = (b_A + b_B + b_C + b_D == 0) ? Math.Pow(10, -1 * (PrecisionTar + 1)) : ZWorkTab[i, j];

                }
            }

            //2. Sweep empty table points (due to lack of data) and estimate value by neighbors
            for (int i = 0; i < 1 + ZWorkTab.GetUpperBound(0); i++) //i sweeps Y
            {
                for (int j = 0; j < 1 + ZWorkTab.GetUpperBound(1); j++)//j sweeps X
                {
                    ZWorkTab[i, j] += (ZWorkTab[i, j] == 0) ? Math.Pow(10, -1 * (PrecisionTar + 1)) : 0;

                    if (ZTabStatus[i, j] == 0)// Empty position gotten
                    {
                        double Z_Ya = 0, Z_Yb = 0, Z_Xa = 0, Z_Xb = 0;
                        byte b_Ya = 0, b_Yb = 0, b_Xa = 0, b_Xb = 0;

                        Z_Ya = (i == 0) ? 0 : ZWorkTab[i - 1, j];< DirectedGraph DataVirtualized = "True" xmlns = "http://schemas.microsoft.com/vs/2009/dgml" >
   
     < Nodes >
   
       < Node Id = "(@1)" Visibility = "Hidden" />
      
          < Node Id = "(@2)" Visibility = "Hidden" />
         
             < Node Id = "(@3 Namespace=CalibrationHelper Type=CalibrationMethods)" Visibility = "Hidden" />
            
                < Node Id = "@4" Visibility = "Hidden" />
               
                   < Node Id = "@5" Category = "CodeSchema_Class" Bounds = "209.424230824651,106.805014491085,196.793333333333,25" CodeSchemaProperty_IsAbstract = "True" CodeSchemaProperty_IsFinal = "True" CodeSchemaProperty_IsPublic = "True" DelayedChildNodesState = "NotFetched" DelayedCrossGroupLinksState = "Fetched" Group = "Collapsed" IsDragSource = "True" Label = "TabManagementMethods" UseManualLocation = "True" />
                                      
                                        </ Nodes >
                                      
                                        < Links >
                                      
                                          < Link Source = "(@2)" Target = "@5" Category = "CodeSchema_Calls" Bounds = "163.002542367048,-266.61206273113,136.965619231411,364.990828741011" IsSourceVirtualized = "True" IsTargetVirtualized = "True" Weight = "11" />
                                                   
                                                       < Link Source = "(@3 Namespace=CalibrationHelper Type=CalibrationMethods)" Target = "@5" Category = "CodeSchema_Calls" Bounds = "334.545563254141,75.1175144910853,41.0912107531632,26.7742299950568" IsSourceVirtualized = "True" IsTargetVirtualized = "True" Weight = "9" />
                                                                
                                                                    < Link Source = "@4" Target = "@5" Category = "Contains" FetchingParent = "@4" />
                                                                       
                                                                           < Link Source = "@5" Target = "(@1)" Category = "References" IsSourceVirtualized = "True" IsTargetVirtualized = "True" Weight = "21" >
                                                                                  
                                                                                        < Category Ref = "CodeSchema_Calls" />
                                                                                   
                                                                                         < Category Ref = "CodeSchema_ReturnTypeLink" />
                                                                                    
                                                                                        </ Link >
                                                                                    
                                                                                      </ Links >
                                                                                    
                                                                                      < Categories >
                                                                                    
                                                                                        < Category Id = "CodeSchema_Calls" Label = "Calls" CanBeDataDriven = "True" CanLinkedNodesBeDataDriven = "True" IncomingActionLabel = "Called By" OutgoingActionLabel = "Calls" />
                                                                                               
                                                                                                   < Category Id = "CodeSchema_Class" Label = "Class" BasedOn = "CodeSchema_Type" CanBeDataDriven = "True" DefaultAction = "Node:Both:CodeSchema_Member" Icon = "CodeSchema_Class" NavigationActionLabel = "Classes" />
                                                                                                            
                                                                                                                < Category Id = "CodeSchema_ReturnTypeLink" Label = "Return" CanBeDataDriven = "True" CanLinkedNodesBeDataDriven = "True" IncomingActionLabel = "Return types" OutgoingActionLabel = "Return types" />
                                                                                                                       
                                                                                                                           < Category Id = "CodeSchema_Type" Label = "Type" CanBeDataDriven = "True" DefaultAction = "Node:Both:CodeSchema_Member" Icon = "CodeSchema_Class" NavigationActionLabel = "Types" />
                                                                                                                                  
                                                                                                                                      < Category Id = "Contains" Label = "Contains" Description = "Whether the source of the link contains the target object" CanBeDataDriven = "False" CanLinkedNodesBeDataDriven = "True" IncomingActionLabel = "Contained By" IsContainment = "True" OutgoingActionLabel = "Contains" />
                                                                                                                                                 
                                                                                                                                                     < Category Id = "References" Label = "References" CanBeDataDriven = "True" CanLinkedNodesBeDataDriven = "True" IncomingActionLabel = "Referenced By" OutgoingActionLabel = "References" />
                                                                                                                                                            
                                                                                                                                                              </ Categories >
                                                                                                                                                            
                                                                                                                                                              < Properties >
                                                                                                                                                            
                                                                                                                                                                < Property Id = "Bounds" DataType = "System.Windows.Rect" />
                                                                                                                                                               
                                                                                                                                                                   < Property Id = "CanBeDataDriven" Label = "CanBeDataDriven" Description = "CanBeDataDriven" DataType = "System.Boolean" />
                                                                                                                                                                      
                                                                                                                                                                          < Property Id = "CanLinkedNodesBeDataDriven" Label = "CanLinkedNodesBeDataDriven" Description = "CanLinkedNodesBeDataDriven" DataType = "System.Boolean" />
                                                                                                                                                                             
                                                                                                                                                                                 < Property Id = "CodeSchemaProperty_IsAbstract" Label = "Is Abstract" Description = "Flag to indicate member is 'Abstract' does not provide a full implementation" DataType = "System.Boolean" />
                                                                                                                                                                                    
                                                                                                                                                                                        < Property Id = "CodeSchemaProperty_IsFinal" Label = "Is Final" Description = "Flag to indicate the member is 'Final' and cannot be derived from" DataType = "System.Boolean" />
                                                                                                                                                                                           
                                                                                                                                                                                               < Property Id = "CodeSchemaProperty_IsPublic" Label = "Is Public" Description = "Flag to indicate the scope is Public" DataType = "System.Boolean" />
                                                                                                                                                                                                  
                                                                                                                                                                                                      < Property Id = "DataVirtualized" Label = "Data Virtualized" Description = "If true, the graph can contain nodes and links that represent data for virtualized nodes/links (i.e. not actually created in the graph)." DataType = "System.Boolean" />
                                                                                                                                                                                                         
                                                                                                                                                                                                             < Property Id = "DefaultAction" Label = "DefaultAction" Description = "DefaultAction" DataType = "System.String" />
                                                                                                                                                                                                                
                                                                                                                                                                                                                    < Property Id = "DelayedChildNodesState" Label = "Delayed Child Nodes State" Description = "Unspecified if the delayed child nodes state is not specified. NotFetched if the group contains child nodes that are not fetched into the graph yet. Fetched if the group has all its delayed child nodes already fetched." DataType = "Microsoft.VisualStudio.GraphModel.DelayedDataState" />
                                                                                                                                                                                                                       
                                                                                                                                                                                                                           < Property Id = "DelayedCrossGroupLinksState" Label = "Delayed Cross-Group Links State" Description = "Unspecified if the delayed cross-group links state is not specified. NotFetched if delayed cross-group links on this node are not fetched into the graph yet. Fetched if all delayed cross-group links have already fetched." DataType = "Microsoft.VisualStudio.GraphModel.DelayedDataState" />
                                                                                                                                                                                                                              
                                                                                                                                                                                                                                  < Property Id = "Expression" DataType = "System.String" />
                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                     < Property Id = "FetchingParent" DataType = "Microsoft.VisualStudio.GraphModel.GraphNodeId" />
                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                        < Property Id = "Group" Label = "Group" Description = "Display the node as a group" DataType = "Microsoft.VisualStudio.GraphModel.GraphGroupStyle" />
                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                               < Property Id = "GroupLabel" DataType = "System.String" />
                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                  < Property Id = "Icon" Label = "Icon" Description = "Icon" DataType = "System.String" />
                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                         < Property Id = "IncomingActionLabel" Label = "IncomingActionLabel" Description = "IncomingActionLabel" DataType = "System.String" />
                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                < Property Id = "IsContainment" DataType = "System.Boolean" />
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                   < Property Id = "IsDragSource" Label = "IsDragSource" Description = "IsDragSource" DataType = "System.Boolean" />
                                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                          < Property Id = "IsEnabled" DataType = "System.Boolean" />
                                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                             < Property Id = "IsSourceVirtualized" Label = "Link Source Virtualized" Description = "If true, the link source end contains data for virtualized nodes/links (i.e. not actually created in the graph)." DataType = "System.Boolean" />
                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                    < Property Id = "IsTargetVirtualized" Label = "Link Target Virtualized" Description = "If true, the link target end contains data for virtualized nodes/links (i.e. not actually created in the graph)." DataType = "System.Boolean" />
                                                                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                                                           < Property Id = "Label" Label = "Label" Description = "Displayable label of an Annotatable object" DataType = "System.String" />
                                                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                                  < Property Id = "NavigationActionLabel" Label = "NavigationActionLabel" Description = "NavigationActionLabel" DataType = "System.String" />
                                                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                                                         < Property Id = "OutgoingActionLabel" Label = "OutgoingActionLabel" Description = "OutgoingActionLabel" DataType = "System.String" />
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                < Property Id = "TargetType" DataType = "System.Type" />
                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                   < Property Id = "UseManualLocation" DataType = "System.Boolean" />
                                                                                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                                                                      < Property Id = "Value" DataType = "System.String" />
                                                                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                                                                         < Property Id = "ValueLabel" DataType = "System.String" />
                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                            < Property Id = "Visibility" Label = "Visibility" Description = "Defines whether a node in the graph is visible or not" DataType = "System.Windows.Visibility" />
                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                   < Property Id = "Weight" Label = "Weight" Description = "Weight" DataType = "System.Double" />
                                                                                                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                                                                                        </ Properties >
                                                                                                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                                                                                        < QualifiedNames >
                                                                                                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                                                                                          < Name Id = "Assembly" Label = "Assembly" ValueType = "Uri" />
                                                                                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                                                                                               < Name Id = "Namespace" Label = "Namespace" ValueType = "System.String" />
                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                    < Name Id = "Type" Label = "Type" ValueType = "System.Object" />
                                                                                                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                                                                                                       </ QualifiedNames >
                                                                                                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                                                                                                       < IdentifierAliases >
                                                                                                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                                                                                                         < Alias n = "1" Uri = "Assembly=$(FxReferenceAssembliesUri)/.NETFramework/v4.7.2/mscorlib.dll" />
                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                            < Alias n = "2" Uri = "Assembly=$(b50016c6-66cb-415d-acf9-02616b573f05.OutputPathUri)" />
                                                                                                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                                                                                                               < Alias n = "3" Uri = "Assembly=$(bbbd0bb8-b265-447b-9883-14dc4ec9f8ed.OutputPathUri)" />
                                                                                                                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                                                                                                  < Alias n = "4" Id = "(@3 Namespace=CalibrationHelper)" />
                                                                                                                                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                                                                                                                     < Alias n = "5" Id = "(@3 Namespace=CalibrationHelper Type=TabManagementMethods)" />
                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                      </ IdentifierAliases >
                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                      < Styles >
                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                        < Style TargetType = "Node" GroupLabel = "Results" ValueLabel = "True" >
                                                                                                                                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                                                                                                                               < Condition Expression = "HasCategory('QueryResult')" />
                                                                                                                                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                                                                                                                                                < Setter Property = "Background" Value = "#FFBCFFBE" />
                                                                                                                                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                                                                                                                                 </ Style >
                                                                                                                                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                                                                                                                                 < Style TargetType = "Node" GroupLabel = "Test Project" ValueLabel = "Test Project" >
                                                                                                                                                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                                                                                                                                        < Condition Expression = "HasCategory('CodeMap_TestProject')" />
                                                                                                                                                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                                                                                                                                         < Setter Property = "Icon" Value = "CodeMap_TestProject" />
                                                                                                                                                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                                                                                                                                            < Setter Property = "Background" Value = "#FF307A69" />
                                                                                                                                                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                                                                                                                                             </ Style >
                                                                                                                                                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                                                                                                                                             < Style TargetType = "Node" GroupLabel = "Web Project" ValueLabel = "Web Project" >
                                                                                                                                                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                                                                                                                                    < Condition Expression = "HasCategory('CodeMap_WebProject')" />
                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                     < Setter Property = "Icon" Value = "CodeMap_WebProject" />
                                                                                                                                                                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                                                                                                                                                      </ Style >
                                                                                                                                                                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                                                                                                                                                      < Style TargetType = "Node" GroupLabel = "Windows Store Project" ValueLabel = "Windows Store Project" >
                                                                                                                                                                                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                                                                                                                                                                             < Condition Expression = "HasCategory('CodeMap_WindowsStoreProject')" />
                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                              < Setter Property = "Icon" Value = "CodeMap_WindowsStoreProject" />
                                                                                                                                                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                                                                                                                                                               </ Style >
                                                                                                                                                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                                                                                                                                                               < Style TargetType = "Node" GroupLabel = "Phone Project" ValueLabel = "Phone Project" >
                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                      < Condition Expression = "HasCategory('CodeMap_PhoneProject')" />
                                                                                                                                                                                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                                                                                                                                                                       < Setter Property = "Icon" Value = "CodeMap_PhoneProject" />
                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                        </ Style >
                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                        < Style TargetType = "Node" GroupLabel = "Portable Library" ValueLabel = "Portable Library" >
                                                                                                                                                                                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                                                                                                                                                                               < Condition Expression = "HasCategory('CodeMap_PortableLibraryProject')" />
                                                                                                                                                                                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                                                                                                                                                                                                < Setter Property = "Icon" Value = "CodeMap_PortableLibraryProject" />
                                                                                                                                                                                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                                                                                                                                                                                 </ Style >
                                                                                                                                                                                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                                                                                                                                                                                 < Style TargetType = "Node" GroupLabel = "WPF Project" ValueLabel = "WPF Project" >
                                                                                                                                                                                                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                                                                                                                                                                                        < Condition Expression = "HasCategory('CodeMap_WpfProject')" />
                                                                                                                                                                                                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                                                                                                                                                                                         < Setter Property = "Icon" Value = "CodeMap_WpfProject" />
                                                                                                                                                                                                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                                                                                                                                                                                          </ Style >
                                                                                                                                                                                                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                                                                                                                                                                                          < Style TargetType = "Node" GroupLabel = "VSIX Project" ValueLabel = "VSIX Project" >
                                                                                                                                                                                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                                                                                                                                                                                                 < Condition Expression = "HasCategory('CodeMap_VsixProject')" />
                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                  < Setter Property = "Icon" Value = "CodeMap_VsixProject" />
                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                   </ Style >
                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                   < Style TargetType = "Node" GroupLabel = "Modeling Project" ValueLabel = "Modeling Project" >
                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                          < Condition Expression = "HasCategory('CodeMap_ModelingProject')" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                                                                                                                                                                                                           < Setter Property = "Icon" Value = "CodeMap_ModelingProject" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                            </ Style >
                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                            < Style TargetType = "Node" GroupLabel = "Assembly" ValueLabel = "Has category" >
                                                                                                                                                                                                                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   < Condition Expression = "HasCategory('CodeSchema_Assembly')" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                                                                                                                                                                                                    < Setter Property = "Background" Value = "#FF094167" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                       < Setter Property = "Stroke" Value = "#FF094167" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                          < Setter Property = "Icon" Value = "CodeSchema_Assembly" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                                                                                                                                                                                                                                           </ Style >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                                                                                                                                                                                                                                           < Style TargetType = "Node" GroupLabel = "Namespace" ValueLabel = "Has category" >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  < Condition Expression = "HasCategory('CodeSchema_Namespace')" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   < Setter Property = "Background" Value = "#FF0E619A" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      < Setter Property = "Stroke" Value = "#FF0E619A" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         < Setter Property = "Icon" Value = "CodeSchema_Namespace" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          </ Style >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          < Style TargetType = "Node" GroupLabel = "Interface" ValueLabel = "Has category" >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 < Condition Expression = "HasCategory('CodeSchema_Interface')" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  < Setter Property = "Background" Value = "#FF1382CE" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     < Setter Property = "Stroke" Value = "#FF1382CE" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        < Setter Property = "Icon" Value = "CodeSchema_Interface" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         </ Style >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         < Style TargetType = "Node" GroupLabel = "Struct" ValueLabel = "Has category" >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                < Condition Expression = "HasCategory('CodeSchema_Struct')" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 < Setter Property = "Background" Value = "#FF1382CE" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    < Setter Property = "Stroke" Value = "#FF1382CE" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       < Setter Property = "Icon" Value = "CodeSchema_Struct" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </ Style >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        < Style TargetType = "Node" GroupLabel = "Enumeration" ValueLabel = "Has category" >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               < Condition Expression = "HasCategory('CodeSchema_Enum')" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                < Setter Property = "Background" Value = "#FF1382CE" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   < Setter Property = "Stroke" Value = "#FF1382CE" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      < Setter Property = "Icon" Value = "CodeSchema_Enum" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         < Setter Property = "LayoutSettings" Value = "List" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          </ Style >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          < Style TargetType = "Node" GroupLabel = "Delegate" ValueLabel = "Has category" >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 < Condition Expression = "HasCategory('CodeSchema_Delegate')" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  < Setter Property = "Background" Value = "#FF1382CE" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     < Setter Property = "Stroke" Value = "#FF1382CE" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        < Setter Property = "Icon" Value = "CodeSchema_Delegate" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         </ Style >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         < Style TargetType = "Node" GroupLabel = "Class" ValueLabel = "Has category" >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                < Condition Expression = "HasCategory('CodeSchema_Type')" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 < Setter Property = "Background" Value = "#FF0E70C0" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    < Setter Property = "Stroke" Value = "#FF0E70C0" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       < Setter Property = "Icon" Value = "CodeSchema_Class" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </ Style >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        < Style TargetType = "Node" GroupLabel = "Property" ValueLabel = "Has category" >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               < Condition Expression = "HasCategory('CodeSchema_Property')" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                < Setter Property = "Background" Value = "#FFE0E0E0" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   < Setter Property = "Stroke" Value = "#FFE0E0E0" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      < Setter Property = "Icon" Value = "CodeSchema_Property" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       </ Style >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       < Style TargetType = "Node" GroupLabel = "Method" ValueLabel = "Has category" >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              < Condition Expression = "HasCategory('CodeSchema_Method') Or HasCategory('CodeSchema_CallStackUnresolvedMethod')" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               < Setter Property = "Background" Value = "#FFE0E0E0" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  < Setter Property = "Stroke" Value = "#FFE0E0E0" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     < Setter Property = "Icon" Value = "CodeSchema_Method" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        < Setter Property = "LayoutSettings" Value = "List" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         </ Style >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         < Style TargetType = "Node" GroupLabel = "Event" ValueLabel = "Has category" >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                < Condition Expression = "HasCategory('CodeSchema_Event')" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 < Setter Property = "Background" Value = "#FFE0E0E0" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    < Setter Property = "Stroke" Value = "#FFE0E0E0" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       < Setter Property = "Icon" Value = "CodeSchema_Event" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </ Style >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        < Style TargetType = "Node" GroupLabel = "Field" ValueLabel = "Has category" >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               < Condition Expression = "HasCategory('CodeSchema_Field')" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                < Setter Property = "Background" Value = "#FFE0E0E0" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   < Setter Property = "Stroke" Value = "#FFE0E0E0" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      < Setter Property = "Icon" Value = "CodeSchema_Field" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       </ Style >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       < Style TargetType = "Node" GroupLabel = "Out Parameter" ValueLabel = "Has category" >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              < Condition Expression = "CodeSchemaProperty_IsOut = 'True'" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               < Setter Property = "Icon" Value = "CodeSchema_OutParameter" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </ Style >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                < Style TargetType = "Node" GroupLabel = "Parameter" ValueLabel = "Has category" >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       < Condition Expression = "HasCategory('CodeSchema_Parameter')" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        < Setter Property = "Icon" Value = "CodeSchema_Parameter" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         </ Style >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         < Style TargetType = "Node" GroupLabel = "Local Variable" ValueLabel = "Has category" >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                < Condition Expression = "HasCategory('CodeSchema_LocalExpression')" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 < Setter Property = "Icon" Value = "CodeSchema_LocalExpression" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  </ Style >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  < Style TargetType = "Node" GroupLabel = "Externals" ValueLabel = "Has category" >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         < Condition Expression = "HasCategory('Externals')" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          < Setter Property = "Background" Value = "#FF424242" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             < Setter Property = "Stroke" Value = "#FF424242" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              </ Style >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              < Style TargetType = "Link" GroupLabel = "Inherits From" ValueLabel = "True" >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     < Condition Expression = "HasCategory('InheritsFrom')" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      < Setter Property = "Stroke" Value = "#FF00A600" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         < Setter Property = "StrokeDashArray" Value = "2 0" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            < Setter Property = "DrawArrow" Value = "true" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             </ Style >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             < Style TargetType = "Link" GroupLabel = "Implements" ValueLabel = "True" >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    < Condition Expression = "HasCategory('Implements')" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     < Setter Property = "Stroke" Value = "#8000A600" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        < Setter Property = "StrokeDashArray" Value = "2 2" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           < Setter Property = "DrawArrow" Value = "true" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </ Style >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            < Style TargetType = "Link" GroupLabel = "Calls" ValueLabel = "True" >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   < Condition Expression = "HasCategory('CodeSchema_Calls')" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    < Setter Property = "Stroke" Value = "#FFFF00FF" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       < Setter Property = "StrokeDashArray" Value = "2 0" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          < Setter Property = "DrawArrow" Value = "true" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           </ Style >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           < Style TargetType = "Link" GroupLabel = "Function Pointer" ValueLabel = "True" >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  < Condition Expression = "HasCategory('CodeSchema_FunctionPointer')" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   < Setter Property = "Stroke" Value = "#FFFF00FF" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      < Setter Property = "StrokeDashArray" Value = "2 2" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         < Setter Property = "DrawArrow" Value = "true" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          </ Style >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          < Style TargetType = "Link" GroupLabel = "Field Read" ValueLabel = "True" >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 < Condition Expression = "HasCategory('CodeSchema_FieldRead')" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  < Setter Property = "Stroke" Value = "#FF00AEEF" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     < Setter Property = "StrokeDashArray" Value = "2 2" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        < Setter Property = "DrawArrow" Value = "true" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         </ Style >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         < Style TargetType = "Link" GroupLabel = "Field Write" ValueLabel = "True" >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                < Condition Expression = "HasCategory('CodeSchema_FieldWrite')" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 < Setter Property = "Stroke" Value = "#FF00AEEF" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    < Setter Property = "DrawArrow" Value = "true" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       < Setter Property = "IsHidden" Value = "false" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </ Style >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        < Style TargetType = "Link" GroupLabel = "Inherits From" ValueLabel = "True" Visibility = "Hidden" >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 < Condition Expression = "HasCategory('InheritsFrom') And Target.HasCategory('CodeSchema_Class')" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  < Setter Property = "TargetDecorator" Value = "OpenArrow" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   </ Style >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   < Style TargetType = "Link" GroupLabel = "Implements" ValueLabel = "True" Visibility = "Hidden" >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            < Condition Expression = "HasCategory('Implements') And Target.HasCategory('CodeSchema_Interface')" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             < Setter Property = "TargetDecorator" Value = "OpenArrow" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              </ Style >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              < Style TargetType = "Link" GroupLabel = "Comment Link" ValueLabel = "True" Visibility = "Hidden" >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       < Condition Expression = "Source.HasCategory('Comment')" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        < Setter Property = "Stroke" Value = "#FFE5C365" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         </ Style >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         < Style TargetType = "Node" GroupLabel = "Cursor Location Changed" ValueLabel = "True" Visibility = "Hidden" >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  < Condition Expression = "IsCursorLocation" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   < Setter Property = "IndicatorWest" Value = "WestIndicator" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </ Style >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    < Style TargetType = "Node" GroupLabel = "Disabled Breakpoint Location Changed" ValueLabel = "True" Visibility = "Hidden" >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             < Condition Expression = "DisabledBreakpointCount" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              < Setter Property = "IndicatorWest" Value = "WestIndicator" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               </ Style >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               < Style TargetType = "Node" GroupLabel = "Enabled Breakpoint Location Changed" ValueLabel = "True" Visibility = "Hidden" >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        < Condition Expression = "EnabledBreakpointCount" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         < Setter Property = "IndicatorWest" Value = "WestIndicator" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          </ Style >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          < Style TargetType = "Node" GroupLabel = "Instruction Pointer Location Changed" ValueLabel = "True" Visibility = "Hidden" >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   < Condition Expression = "IsInstructionPointerLocation" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    < Setter Property = "IndicatorWest" Value = "WestIndicator" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     </ Style >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     < Style TargetType = "Node" GroupLabel = "Current Callstack Changed" ValueLabel = "True" Visibility = "Hidden" >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              < Condition Expression = "IsCurrentCallstackFrame" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               < Setter Property = "IndicatorWest" Value = "WestIndicator" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </ Style >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                < Style TargetType = "Link" GroupLabel = "Return" ValueLabel = "True" Visibility = "Hidden" >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         < Condition Expression = "HasCategory('CodeSchema_ReturnTypeLink')" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </ Style >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        < Style TargetType = "Link" GroupLabel = "References" ValueLabel = "True" Visibility = "Hidden" >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 < Condition Expression = "HasCategory('References')" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </ Style >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                < Style TargetType = "Link" GroupLabel = "Uses Attribute" ValueLabel = "True" Visibility = "Hidden" >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         < Condition Expression = "HasCategory('CodeSchema_AttributeUse')" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </ Style >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        < Style TargetType = "Node" GroupLabel = "Solution Folder" ValueLabel = "True" Visibility = "Hidden" >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 < Condition Expression = "HasCategory('CodeMap_SolutionFolder')" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  < Setter Property = "Background" Value = "#FFDEBA83" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   </ Style >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   < Style TargetType = "Link" GroupLabel = "Project Reference" ValueLabel = "Project Reference" >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          < Condition Expression = "HasCategory('CodeMap_ProjectReference')" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           < Setter Property = "Stroke" Value = "#9A9A9A" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              < Setter Property = "StrokeDashArray" Value = "2 2" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 < Setter Property = "DrawArrow" Value = "true" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  </ Style >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  < Style TargetType = "Link" GroupLabel = "External Reference" ValueLabel = "External Reference" >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         < Condition Expression = "HasCategory('CodeMap_ExternalReference')" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          < Setter Property = "Stroke" Value = "#9A9A9A" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             < Setter Property = "StrokeDashArray" Value = "2 2" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                < Setter Property = "DrawArrow" Value = "true" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 </ Style >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               </ Styles >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               < Paths >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 < Path Id = "b50016c6-66cb-415d-acf9-02616b573f05.OutputPathUri" Value = "file:///C:/Users/Matheus/source/repos/CalibrationHelper/CalibrationHelperTests/bin/Debug/CalibrationHelperTests.dll" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    < Path Id = "bbbd0bb8-b265-447b-9883-14dc4ec9f8ed.OutputPathUri" Value = "file:///C:/Users/Matheus/source/repos/CalibrationHelper/CalibrationHelper/bin/Debug/CalibrationHelper.exe" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       < Path Id = "FxReferenceAssembliesUri" Value = "file:///C:/Program Files (x86)/Reference Assemblies/Microsoft/Framework" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </ Paths >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      </ DirectedGraph >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Z_Yb = (i == ZWorkTab.GetUpperBound(0)) ? 0 : ZWorkTab[i + 1, j];
                        Z_Xa = (j == 0) ? 0 : ZWorkTab[i, j - 1];
                        Z_Xb = (j == ZWorkTab.GetUpperBound(1)) ? 0 : ZWorkTab[i, j + 1];

                        b_Ya = (byte)((i == 0) ? 0 : ZTabStatus[i - 1, j]);
                        b_Yb = (byte)((i == ZWorkTab.GetUpperBound(0)) ? 0 : ZTabStatus[i + 1, j]);
                        b_Xa = (byte)((j == 0) ? 0 : ZTabStatus[i, j - 1]);
                        b_Xb = (byte)((j == ZWorkTab.GetUpperBound(1)) ? 0 : ZTabStatus[i, j + 1]);


                        ZWorkTab[i, j] = (b_Ya + b_Yb + b_Xa + b_Xb) != 0 ?
                            (b_Ya * Z_Ya + b_Yb * Z_Yb + b_Xa * Z_Xa + b_Xb * Z_Xb) / (b_Ya + b_Yb + b_Xa + b_Xb) :
                            Math.Pow(10, -1 * (PrecisionTar + 1));

                        ZWorkTab[i, j] += Math.Pow(10, -1 * (PrecisionTar + 1));
                    }
                }
            }

            //3. Sweep each table point and adjust to dimish Z Ratio average deviation
            double MFactor = 1.25;
            double[] ZRatioArray = CalibrationMethods.CalibrationRatioArrayCalculation(DataX, DataY, DataZ, XBkpt, YBkpt, ZWorkTab);
            double ZErr = VectorStatBasicMethods.ErrorsStdDev(DataZ,
                CalibrationMethods.CalibrationAbsoluteArrayCalculation(DataX, DataY, DataZ, XBkpt, YBkpt, ZWorkTab)), ZErrOld;

            if (ProgressBox != null)
            {
                ProgressBox.ProgressBoxStart(); //If delivered, ProgressBox is desired, thus start ProgressBox
            }

            if (ProgressBox != null)
            {
                ProgressBox.ProgressBoxUpdate(0); //If delivered, ProgressBox is desired, thus set ProgressBox=0
            }

            for (int P2A = 0; P2A < FineTuneIterBox; P2A++)
            {
                for (int i = 0; i < 1 + ZWorkTab.GetUpperBound(0); i++) //i sweeps Y
                {
                    for (int j = 0; j < 1 + ZWorkTab.GetUpperBound(1); j++)//j sweeps X
                    {
                        int LoopSkip = 0;

                        if (FitType == false) //Absolute Error optimization
                        {
                            ZErr = VectorStatBasicMethods.ErrorsStdDev(DataZ,
                                CalibrationMethods.CalibrationAbsoluteArrayCalculation(DataX, DataY, DataZ, XBkpt, YBkpt, ZWorkTab));
                        }
                        else //Relative Error optimization
                        {
                            ZErr = VectorStatBasicMethods.StdDev(
                                CalibrationMethods.CalibrationRatioArrayCalculation(DataX, DataY, DataZ, XBkpt, YBkpt, ZWorkTab));
                        }

                        for (int P2B = 0; P2B < FineTuneSubIterBox; P2B++)
                        {
                            // Increment or Decrement a Table value by a specific percent
                            ZWorkTab[i, j] *= MFactor;

                            // Evaluate the results of the value increment/decrement in terms of summed squared errors
                            ZErrOld = ZErr;

                            if (FitType == false) //Absolute Error optimization
                            {
                                ZErr = VectorStatBasicMethods.ErrorsStdDev(DataZ,
                                    CalibrationMethods.CalibrationAbsoluteArrayCalculation(DataX, DataY, DataZ, XBkpt, YBkpt, ZWorkTab));
                            }
                            else //Relative Error optimization
                            {
                                ZErr = VectorStatBasicMethods.StdDev(
                                    CalibrationMethods.CalibrationRatioArrayCalculation(DataX, DataY, DataZ, XBkpt, YBkpt, ZWorkTab));
                            }

                            // If the result didn't optimize the StdDev, undo operation and change direction and retrieve old error
                            MFactor = (ZErr >= ZErrOld) ? 1 / MFactor : MFactor;
                            ZWorkTab[i, j] *= (ZErr >= ZErrOld) ? MFactor : 1;
                            ZErr = (ZErr >= ZErrOld) ? ZErrOld : ZErr;

                            // When a second direction change is required (optm reached), break loop and goto next Table position
                            LoopSkip = (P2B == 1 && LoopSkip == 0) ? 1 : LoopSkip;
                            LoopSkip += (ZErr >= ZErrOld) ? 1 : 0;
                            if (LoopSkip == 2)
                            {
                                break;
                            }
                        }

                        if (ProgressBox != null)
                        {
                            ProgressBox.ProgressBoxUpdate(100 * P2A / FineTuneIterBox); //If delivered, ProgressBox is desired, thus set ProgressBox update
                        }
                    }
                }

                MFactor = MFactor < 1 ? 1 / MFactor : MFactor;
                MFactor = ((MFactor - 1) / 2) + 1;

                //Populate the iteration converging error vector to be plotted afterwards
                if (FitType == false)
                {
                    ErrStep[P2A + 1] = VectorStatBasicMethods.ErrorsAvg(DataZ,
                         CalibrationMethods.CalibrationAbsoluteArrayCalculation(DataX, DataY, DataZ, XBkpt, YBkpt, ZWorkTab));
                    StdDStep[P2A + 1] = VectorStatBasicMethods.ErrorsStdDev(DataZ,
                         CalibrationMethods.CalibrationAbsoluteArrayCalculation(DataX, DataY, DataZ, XBkpt, YBkpt, ZWorkTab));
                }
                else
                {
                    ErrStep[P2A + 1] = VectorStatBasicMethods.Mean(
                         CalibrationMethods.CalibrationAbsoluteArrayCalculation(DataX, DataY, DataZ, XBkpt, YBkpt, ZWorkTab));
                    StdDStep[P2A + 1] = VectorStatBasicMethods.StdDev(
                        CalibrationMethods.CalibrationAbsoluteArrayCalculation(DataX, DataY, DataZ, XBkpt, YBkpt, ZWorkTab));
                }

            }

            if (ProgressBox != null)
            {
                ProgressBox.ProgressBoxFinish(); //If delivered, ProgressBox is desired, thus finish ProgressBox
            }

            //4 Adjust Calibration Table values - MeanTar, Decimal Places, Round Values
            double ZMean = VectorStatBasicMethods.Mean(ZRatioArray);
            for (int i = 0; i < 1 + ZWorkTab.GetUpperBound(0); i++) //i sweeps Y
            {
                for (int j = 0; j < 1 + ZWorkTab.GetUpperBound(1); j++)//j sweeps X
                {
                    if (FitType == false) //If Absolute Fit
                    {
                        ZWorkTab[i, j] += ErrStep[ErrStep.GetUpperBound(0) - 1] + MeanTar;
                    }
                    else //If Relative Fit
                    {
                        ZWorkTab[i, j] *= MeanTar * VectorStatBasicMethods.Mean(
                                    CalibrationMethods.CalibrationRatioArrayCalculation(DataX, DataY, DataZ, XBkpt, YBkpt, ZWorkTab)); ;
                    }

                    ZWorkTab[i, j] = Math.Round(ZWorkTab[i, j], PrecisionTar);
                }
            }

            //5. Populate the iteration converging error vector (last position) to be plotted afterwards
            if (FitType == false)
            {
                ErrStep[ErrStep.GetUpperBound(0)] = VectorStatBasicMethods.ErrorsAvg(DataZ,
                     CalibrationMethods.CalibrationAbsoluteArrayCalculation(DataX, DataY, DataZ, XBkpt, YBkpt, ZWorkTab));
                StdDStep[ErrStep.GetUpperBound(0)] = VectorStatBasicMethods.ErrorsStdDev(DataZ,
                      CalibrationMethods.CalibrationAbsoluteArrayCalculation(DataX, DataY, DataZ, XBkpt, YBkpt, ZWorkTab));
            }
            else
            {
                ErrStep[ErrStep.GetUpperBound(0)] = VectorStatBasicMethods.Mean(
                     CalibrationMethods.CalibrationAbsoluteArrayCalculation(DataX, DataY, DataZ, XBkpt, YBkpt, ZWorkTab));
                StdDStep[ErrStep.GetUpperBound(0)] = VectorStatBasicMethods.StdDev(
                       CalibrationMethods.CalibrationAbsoluteArrayCalculation(DataX, DataY, DataZ, XBkpt, YBkpt, ZWorkTab));
            }

            return ZWorkTab;
        }
    }
}
